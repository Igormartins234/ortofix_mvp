<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OrtoFix - Cadastro de Aluno</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <style> 
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #e3ebf2;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">
    <div class="mb-8 text-center">
        <a href="../index.html">
            <img src="../static/img/ortofix.png" alt="OrtoFix Logo" class="mx-auto h-20">
        </a>
    </div>

    <div class="bg-white shadow-xl rounded-xl p-8 md:p-10 w-full max-w-md">
        <h2 class="text-2xl font-bold text-[#3c6a99] mb-6 text-center">Cadastro do Aluno</h2>
        
        <!-- Formulário atualizado com ID e novos campos -->
        <form id="cadastro-form" class="space-y-4">
    <!-- Campos de nome, cpf, email, senha (sem alterações) -->
    <div>
        <label for="nome" class="block text-[#5689b9] text-sm font-semibold mb-2">Nome Completo:</label>
        <input type="text" id="nome" required class="w-full ...">
    </div>
    <!-- ... outros campos ... -->
    <div>
        <label for="senha" class="block ...">Senha:</label>
        <input type="password" id="senha" required class="w-full ...">
    </div>

    <!-- NOVO CAMPO DE SELEÇÃO DE PROFESSOR -->
    <div>
        <label for="professor" class="block text-[#5689b9] text-sm font-semibold mb-2">Seu Professor:</label>
        <select id="professor" required class="w-full px-4 py-2 border border-[#9aaec1] rounded-lg focus:ring-2 focus:ring-[#5689b9] outline-none text-[#3c6a99] bg-white">
            <option value="" disabled selected>Carregando professores...</option>
        </select>
    </div>

    <!-- ... (área de mensagem e botão) ... -->
</form>
<!-- ... -->

<script>
    const form = document.getElementById('cadastro-form');
    const messageArea = document.getElementById('message-area');
    const submitBtn = document.getElementById('submit-btn');
    const professorSelect = document.getElementById('professor');

    // Função para carregar professores na lista
    async function carregarProfessores() {
        try {
            const response = await fetch('https://back-end-mvp-tcc.vercel.app/api/professores/lista');
            if (!response.ok) throw new Error('Não foi possível carregar os professores.');
            
            const professores = await response.json();
            
            professorSelect.innerHTML = '<option value="" disabled selected>Selecione seu professor</option>'; // Limpa e adiciona a opção padrão
            professores.forEach(prof => {
                const option = document.createElement('option');
                option.value = prof.idprofessor;
                option.textContent = prof.nomeprofessor;
                professorSelect.appendChild(option);
            });
        } catch (error) {
            professorSelect.innerHTML = `<option value="" disabled selected>${error.message}</option>`;
        }
    }

    // Carrega os professores quando a página abre
    document.addEventListener('DOMContentLoaded', carregarProfessores);

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        // ... (código existente de feedback) ...

        const nome = document.getElementById('nome').value;
        const cpf = document.getElementById('cpf').value;
        const email = document.getElementById('email').value;
        const senha = document.getElementById('senha').value;
        const idProfessor = professorSelect.value; // Pega o ID do professor selecionado

        // ... (validação de senha, se houver) ...

        try {
            const response = await fetch('https://back-end-mvp-tcc.vercel.app/api/register/aluno', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    nomeAluno: nome,
                    cpfAluno: cpf,
                    emailAluno: email,
                    senhaAluno: senha,
                    idProfessor: idProfessor // Envia o ID do professor
                })
            });
            // ... (resto do código de tratamento de resposta) ...
        } catch (error) {
            // ... (código de erro) ...
        } finally {
            // ... (código do finally) ...
        }
    });
</script>
</body>
</html>